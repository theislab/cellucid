<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cellucid - Interactive Single-Cell Data Visualization</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Cellucid is a high-performance visualization tool for exploring single-cell sequencing data. Visualize millions of cells in 3D with UMAP embeddings, gene expression overlays, and interactive filtering. Free, browser-based, no installation required." />
  <meta name="keywords" content="single-cell, scRNA-seq, UMAP, visualization, WebGL, bioinformatics, gene expression, 3D visualization, cell atlas" />
  <meta name="author" content="Kemal Inecik" />
  <meta name="robots" content="index, follow" />
  <link rel="canonical" href="https://www.cellucid.com" />

  <!-- Open Graph / Social Media -->
  <meta property="og:title" content="cellucid - Interactive Single-Cell Data Visualization" />
  <meta property="og:description" content="Explore single-cell RNA sequencing data in 3D. Visualize millions of cells with UMAP embeddings, gene expression, and interactive filtering. Free and browser-based." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.cellucid.com" />
  <meta property="og:image" content="https://www.cellucid.com/assets/img/og-preview.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="cellucid - Interactive Single-Cell Data Visualization" />
  <meta name="twitter:description" content="Explore single-cell RNA sequencing data in 3D. Visualize millions of cells with UMAP embeddings, gene expression, and interactive filtering." />
  <meta name="twitter:image" content="https://www.cellucid.com/assets/img/og-preview.jpg" />

  <!-- Structured Data for Search Engines -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "cellucid",
    "description": "A high-performance visualization tool for exploring single-cell RNA sequencing data. Visualize millions of cells in 3D with UMAP embeddings, gene expression overlays, categorical filtering, and interactive exploration.",
    "url": "https://www.cellucid.com",
    "image": "https://www.cellucid.com/assets/img/og-preview.jpg",
    "logo": "https://www.cellucid.com/assets/img/android-chrome-512x512.png",
    "applicationCategory": "Scientific Software",
    "operatingSystem": "Any (Web Browser)",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Person",
      "name": "Kemal Inecik",
      "url": "https://kemalinecik.com"
    },
    "featureList": [
      "3D UMAP visualization",
      "Gene expression overlay",
      "Categorical and continuous obs filtering",
      "WebGL2 high-performance rendering",
      "Support for millions of cells",
      "Volumetric smoke cloud rendering",
      "KNN connectivity visualization",
      "Multiple view comparison"
    ]
  }
  </script>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-K4774ZWGEQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-K4774ZWGEQ');
  </script>

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="256x256" href="assets/img/favicon-256x256.png" />
  <link rel="icon" type="image/png" sizes="128x128" href="assets/img/favicon-128x128.png" />
  <link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicon-96x96.png" />
  <link rel="icon" type="image/png" sizes="64x64" href="assets/img/favicon-64x64.png" />
  <link rel="icon" type="image/png" sizes="48x48" href="assets/img/favicon-48x48.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png" />
  <link rel="icon" type="image/svg+xml" href="assets/img/favicon.svg" />
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="assets/img/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="167x167" href="assets/img/apple-touch-icon-167x167.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="assets/img/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="assets/img/apple-touch-icon-120x120.png" />
  <link rel="mask-icon" href="assets/img/safari-pinned-tab.svg" color="#111827" />
  <link rel="manifest" href="site.webmanifest" />
  <meta name="msapplication-config" content="browserconfig.xml" />
  <meta name="msapplication-TileImage" content="assets/img/mstile-150x150.png" />
  <meta name="msapplication-TileColor" content="#111827" />
  <meta name="theme-color" content="#ffffff" />

  <!-- Fonts are now self-hosted in assets/fonts/ for better performance -->
  <link rel="stylesheet" href="assets/css/style.css" />
</head>
<body>
  <!-- SEO: Semantic content for search engines and screen readers (hidden visually) -->
  <main class="sr-only" aria-label="About cellucid">
    <h1>cellucid - Interactive Single-Cell Data Visualization</h1>
    <p>Cellucid is a free, browser-based tool for visualizing single-cell sequencing data in 3D. Built with WebGL2 for high-performance rendering of millions of cells.</p>
    <h2>Key Features</h2>
    <ul>
      <li>3D UMAP and embedding visualization</li>
      <li>Gene expression overlay with searchable gene list</li>
      <li>Categorical and continuous observation filtering</li>
      <li>Support for millions of cells with GPU-accelerated rendering</li>
      <li>Volumetric smoke cloud visualization mode</li>
      <li>KNN connectivity graph visualization</li>
      <li>Multiple view comparison for UMAP parameter exploration</li>
      <li>Outlier filtering in latent space</li>
    </ul>
    <h2>Use Cases</h2>
    <p>Ideal for researchers working with scRNA-seq data, cell atlases, and dimensional reduction visualizations. Compatible with AnnData exports and standard single-cell analysis pipelines.</p>
  </main>

  <noscript>
    <div style="padding: 40px; max-width: 800px; margin: 0 auto; font-family: sans-serif;">
      <h1>cellucid - Interactive Single-Cell Data Visualization</h1>
      <p>Cellucid requires JavaScript and WebGL2 to run. Please enable JavaScript in your browser to use this application.</p>
      <h2>About cellucid</h2>
      <p>Cellucid is a free, browser-based visualization tool for exploring single-cell sequencing data. Visualize millions of cells in 3D with UMAP embeddings, gene expression overlays, and interactive filtering.</p>
      <h3>Features</h3>
      <ul>
        <li>3D UMAP visualization with GPU-accelerated rendering</li>
        <li>Gene expression overlay</li>
        <li>Categorical and continuous obs filtering</li>
        <li>Support for millions of cells</li>
        <li>Volumetric smoke cloud rendering</li>
        <li>KNN connectivity visualization</li>
      </ul>
      <p>Created by <a href="https://kemalinecik.com">Kemal Inecik</a></p>
    </div>
  </noscript>

  <canvas id="glcanvas" tabindex="0"></canvas>

  <!-- Sidebar toggle button -->
  <button id="sidebar-toggle" class="sidebar-open" title="Toggle sidebar">✕</button>

		  <div id="sidebar">
		    <div id="sidebar-resize-handle" title="Drag to resize"></div>
		    <div class="sidebar-scroll">
		      <div class="sidebar-brand">
		        <a class="sidebar-brand-link" href="https://www.cellucid.com" aria-label="Visit cellucid.com">
		          <img src="assets/img/cellucid-logo.svg" alt="cellucid logo" class="sidebar-logo" />
		        </a>
		      </div>

    <div class="accordion">
      <details class="accordion-section" id="session-section" open>
        <summary>Session</summary>
        <div class="accordion-content">
          <!-- Dataset Selector -->
          <div class="control-block">
            <label for="dataset-select">Sample datasets:</label>
            <select id="dataset-select" class="obs-select">
              <option value="" disabled selected>Loading...</option>
            </select>
          </div>

          <!-- Dataset info display -->
          <div id="dataset-info" class="dataset-info">
            <div class="dataset-info-row">
              <span class="dataset-info-label">Dataset</span>
              <span id="dataset-name" class="dataset-info-value">–</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">Description</span>
              <span id="dataset-description" class="dataset-info-value dataset-info-ellipsis" title="—">—</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">Source</span>
              <span id="dataset-source" class="dataset-info-value">–</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">URL</span>
              <span id="dataset-url" class="dataset-info-value dataset-info-ellipsis" title="—">—</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">Cells</span>
              <span id="dataset-cells" class="dataset-info-value">–</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">Genes</span>
              <span id="dataset-genes" class="dataset-info-value">–</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">Obs fields</span>
              <span id="dataset-obs" class="dataset-info-value">–</span>
            </div>
            <div class="dataset-info-row">
              <span class="dataset-info-label">Connectivity</span>
              <span id="dataset-connectivity" class="dataset-info-value">–</span>
            </div>
          </div>

          <!-- User directory selector -->
          <div class="control-block" id="user-data-block" style="margin-top: 4px; position: relative;">
            <label style="display: flex; align-items: center; gap: 4px;">
              Local data:
              <span id="user-data-info-btn" class="info-btn">i</span>
            </label>
            <div id="user-data-info-tooltip" class="info-tooltip" style="display: none;">
              <div class="info-tooltip-content">
                <div class="info-step">Prepare data: <span class="info-cmd">pip install cellucid</span></div>
                <div class="info-step">Docs: <a href="https://cellucid.readthedocs.io" target="_blank" class="info-cmd">cellucid.readthedocs.io</a></div>
              </div>
            </div>
            <label class="sr-only" for="user-data-path">Selected data path</label>
            <div class="user-data-row">
              <input type="text" id="user-data-path" class="user-data-path"
                     placeholder="No directory selected" readonly />
              <button id="user-data-browse-btn" class="reset-btn">Browse</button>
              <!-- Hidden file input for cross-browser directory selection -->
              <input type="file" id="user-data-file-input" webkitdirectory directory multiple
                     style="display:none;" />
            </div>
          </div>

          <!-- Remote server connection -->
          <div class="control-block" id="remote-server-block" style="margin-top: 2px; position: relative;">
            <label style="display: flex; align-items: center; gap: 4px;">
              Remote server:
              <span id="remote-info-btn" class="info-btn">i</span>
            </label>
            <div id="remote-info-tooltip" class="info-tooltip" style="display: none;">
              <div class="info-tooltip-content">
                <div class="info-step">1. On server: <span class="info-cmd">cellucid serve /path/to/data</span></div>
                <div class="info-step">2. Local: <span class="info-cmd">ssh -L 8765:localhost:8765 user@server</span></div>
                <div class="info-step">3. Connect to <span class="info-cmd">http://localhost:8765</span></div>
              </div>
            </div>
            <div class="user-data-row">
              <input type="text" id="remote-server-url" class="user-data-path"
                     placeholder="http://localhost:8765" />
              <button id="remote-connect-btn" class="reset-btn">Connect</button>
            </div>
            <div style="margin-top:4px;">
              <button id="remote-disconnect-btn" class="reset-btn" style="display:none; padding:2px 6px; font-size:11px;">Disconnect</button>
            </div>
          </div>

          <!-- Session state save/load -->
          <div class="control-block" id="session-state-controls" style="margin-top: 0px;">
            <label>Session state:</label>
            <div class="legend-help">
              Save or load the application state including camera, filters, highlights, and settings.
            </div>
            <div class="control-block" style="display: flex; gap: 8px; margin-top: 6px;">
              <button id="save-state-btn" class="reset-btn" style="flex: 1;">Save State</button>
              <button id="load-state-btn" class="reset-btn" style="flex: 1;">Load State</button>
            </div>
          </div>
        </div>
      </details>

      <details class="accordion-section" open>
        <summary>Visualization</summary>
        <div class="accordion-content">
          <!-- Background -->
          <div class="control-block">
            <label for="background-select">Background:</label>
            <select id="background-select">
              <option value="grid" selected>Grid (light)</option>
              <option value="grid-dark">Grid (dark)</option>
              <option value="white">White</option>
              <option value="black">Black</option>
            </select>
          </div>

          <!-- Render mode -->
          <div class="control-block">
            <label for="render-mode">Render mode:</label>
            <select id="render-mode" class="obs-select">
              <option value="points">Points</option>
              <option value="smoke">Volumetric smoke cloud</option>
            </select>
          </div>

          <!-- Depth Perception controls -->
          <div class="control-block" id="depth-controls">
            <label>Depth perception:</label>
            <div class="legend-help">
              Visual cues for 3D depth and spatial awareness.
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="point-size">Point size (log):</label>
              <div class="slider-row">
                <input id="point-size" type="range" min="0" max="100" step="1" value="0" />
                <span id="point-size-display" class="slider-value">1.00</span>
              </div>
            </div>

            <div class="control-block" style="margin-top:6px;">
              <label for="lighting-strength">3D lighting:</label>
              <div class="slider-row">
                <input id="lighting-strength" type="range" min="0" max="100" step="1" value="60" />
                <span id="lighting-strength-display" class="slider-value">60</span>
              </div>
            </div>

            <div class="control-block" style="margin-top:6px;">
              <label for="fog-density">Atmospheric fog:</label>
              <div class="slider-row">
                <input id="fog-density" type="range" min="0" max="100" step="1" value="50" />
                <span id="fog-density-display" class="slider-value">50</span>
              </div>
            </div>

            <div class="control-block" style="margin-top:6px;">
              <label for="size-attenuation">Perspective size scaling:</label>
              <div class="slider-row">
                <input id="size-attenuation" type="range" min="0" max="100" step="1" value="65" />
                <span id="size-attenuation-display" class="slider-value">65</span>
              </div>
            </div>
          </div>

          <!-- Renderer Settings -->
          <div class="control-block" id="renderer-controls">
            <label>Renderer settings:</label>
            <div class="control-block" style="margin-top:6px;">
              <label for="hp-shader-quality">Shader quality:</label>
              <select id="hp-shader-quality" class="obs-select">
                <option value="full">Full (lighting + fog)</option>
                <option value="light">Light (circular, no lighting)</option>
                <option value="ultralight">Ultra-light (square points)</option>
              </select>
            </div>

            <div class="control-block" style="margin-top:6px;">
              <label class="checkbox-inline">
                <input type="checkbox" id="hp-lod-enabled" />
                Level-of-Detail (LOD)
              </label>
            </div>

            <div class="control-block" id="lod-force-container" style="margin-top:4px; margin-left:18px; display:none;">
              <label for="hp-lod-force">Force LOD level:</label>
              <div class="slider-row">
                <input id="hp-lod-force" type="range" min="-1" max="17" step="1" value="-1" />
                <span id="hp-lod-force-label" class="slider-value">Auto</span>
              </div>
            </div>

            <div class="control-block" style="margin-top:6px;">
              <label class="checkbox-inline">
                <input type="checkbox" id="hp-frustum-culling" />
                Frustum culling
              </label>
            </div>
          </div>

          <!-- Volumetric smoke controls -->
          <div class="control-block" id="smoke-controls">
            <label>Volumetric smoke:</label>
            <div class="legend-help">
              Physically-based ray-marched smoke. Knobs auto-scale with grid and noise detail.
            </div>

            <label>Quality & performance:</label>
            <div class="control-block">
              <label for="smoke-grid">Grid density:</label>
              <div class="slider-row">
                <input id="smoke-grid" type="range" min="0" max="100" step="1" value="60" />
                <span id="smoke-grid-display" class="slider-value">256³</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-steps">Ray quality:</label>
              <div class="slider-row">
                <input id="smoke-steps" type="range" min="0" max="100" step="1" value="75" />
                <span id="smoke-steps-display" class="slider-value">High</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="cloud-resolution">Render resolution:</label>
              <div class="slider-row">
                <input id="cloud-resolution" type="range" min="0" max="100" step="1" value="15" />
                <span id="cloud-resolution-display" class="slider-value">0.51x</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="noise-resolution">Noise detail:</label>
              <div class="slider-row">
                <input id="noise-resolution" type="range" min="0" max="100" step="1" value="58" />
                <span id="noise-resolution-display" class="slider-value">128³</span>
              </div>
            </div>

            <label>Shape & motion:</label>
            <div class="control-block">
              <label for="smoke-density">Cloud density:</label>
              <div class="slider-row">
                <input id="smoke-density" type="range" min="0" max="100" step="1" value="56" />
                <span id="smoke-density-display" class="slider-value">9</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-detail">Fine detail:</label>
              <div class="slider-row">
                <input id="smoke-detail" type="range" min="0" max="100" step="1" value="60" />
                <span id="smoke-detail-display" class="slider-value">3.8</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-warp">Turbulence:</label>
              <div class="slider-row">
                <input id="smoke-warp" type="range" min="0" max="100" step="1" value="10" />
                <span id="smoke-warp-display" class="slider-value">10%</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-speed">Animation speed:</label>
              <div class="slider-row">
                <input id="smoke-speed" type="range" min="0" max="100" step="1" value="40" />
                <span id="smoke-speed-display" class="slider-value">1.00</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-edge">Edge softness:</label>
              <div class="slider-row">
                <input id="smoke-edge" type="range" min="0" max="100" step="1" value="0" />
                <span id="smoke-edge-display" class="slider-value">0.2</span>
              </div>
            </div>

            <label>Lighting:</label>
            <div class="control-block">
              <label for="smoke-absorption">Light absorption:</label>
              <div class="slider-row">
                <input id="smoke-absorption" type="range" min="0" max="100" step="1" value="65" />
                <span id="smoke-absorption-display" class="slider-value">1.5</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-scatter">Light scattering:</label>
              <div class="slider-row">
                <input id="smoke-scatter" type="range" min="0" max="100" step="1" value="0" />
                <span id="smoke-scatter-display" class="slider-value">0.0</span>
              </div>
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="smoke-direct-light">Direct lighting:</label>
              <div class="slider-row">
                <input id="smoke-direct-light" type="range" min="0" max="100" step="1" value="3" />
                <span id="smoke-direct-light-display" class="slider-value">0.04x</span>
              </div>
            </div>

          </div>

          <!-- Point rendering controls (points mode only) -->
          <div id="points-controls" class="visible">
            <!-- KNN Connectivity Section -->
            <div class="control-block" id="connectivity-controls" style="display: none;">
              <label>KNN Connectivity:</label>

              <div class="legend-help" style="margin-bottom:6px;">
                Shows edges between visible cells only.
              </div>

              <label class="checkbox-inline">
                <input type="checkbox" id="toggle-connectivity" />
                Show connectivity edges
              </label>

              <div id="connectivity-sliders" class="nav-mode-box" style="display: none;">
                <div class="control-block" style="margin-top:6px;">
                  <label for="connectivity-color">Edge color:</label>
                  <input type="color" id="connectivity-color" value="#4a4a4a" style="width:50px;height:24px;border:none;cursor:pointer;" />
                </div>

                <div class="control-block" style="margin-top:6px;">
                  <label for="connectivity-alpha">Edge opacity:</label>
                  <div class="slider-row">
                    <input id="connectivity-alpha" type="range" min="1" max="100" step="1" value="60" />
                    <span id="connectivity-alpha-display" class="slider-value">0.60</span>
                  </div>
                </div>

                <div class="control-block" style="margin-top:6px;">
                  <label for="connectivity-width">Line width:</label>
                  <div class="slider-row">
                    <input id="connectivity-width" type="range" min="1" max="50" step="1" value="10" />
                    <span id="connectivity-width-display" class="slider-value">1.0</span>
                  </div>
                </div>

                <div class="control-block" style="margin-top:6px;">
                  <label for="connectivity-limit">Max edges:</label>
                  <div class="slider-row">
                    <input id="connectivity-limit" type="range" min="1000" max="1000000" step="1000" value="250000" />
                    <span id="connectivity-limit-display" class="slider-value">250k</span>
                  </div>
                </div>

                <div id="connectivity-info" class="legend-help" style="margin-top:8px; font-variant-numeric: tabular-nums;"></div>
              </div>
            </div>
          </div>

          <!-- Reset Camera -->
          <div class="control-block">
            <button id="reset-camera-btn" class="reset-btn">Reset Camera</button>
          </div>
        </div>
      </details>

      <details class="accordion-section" open>
        <summary>Compare Views</summary>
        <div class="accordion-content">
          <!-- Multiview controls -->
          <div class="control-block" id="split-view-controls">
            <label>Multiview:</label>
            <div class="legend-help">
              Keep snapshots to compare UMAP tweaks. Switch to a single view to edit settings.
            </div>

            <div class="split-view-row" style="margin-top:6px;">
              <button
                id="split-keep-view-btn"
                class="reset-btn"
                title="Freeze current coloring & filters as a new panel"
              >
                Keep view
              </button>
              <button
                id="camera-lock-btn"
                class="toggle-switch camera-lock-btn"
                type="button"
                aria-pressed="false"
                title="Cameras independent (click to link)"
              >
                Locked Cam
              </button>
            </div>

            <div id="split-view-badges-box" class="split-view-badges-box">
              <div id="split-view-badges-list" class="split-view-badges"></div>
              <div class="split-view-hint legend-help"></div>
              <div class="legend-actions compact split-view-actions" style="display:flex; justify-content:space-between; align-items:center;">
                <div style="display:flex; align-items:center; gap:6px;">
                  <span class="legend-help" style="margin:0;">Layout:</span>
                  <select id="view-layout-mode" class="obs-select" style="width:100px;">
                    <option value="grid">Grid compare</option>
                    <option value="single">Edit selected view</option>
                  </select>
                </div>
                <button
                  id="split-clear-btn"
                  class="reset-btn"
                  title="Remove all kept views"
                >
                  Clear
                </button>
              </div>
            </div>
          </div>

          <!-- Dimension Level Selector -->
          <div id="dimension-controls" class="control-block dimension-controls" style="display:none;">
            <label for="dimension-select">Dimension:</label>
            <div class="legend-help">
              Switch between embeddings for the current view.
            </div>
            <div class="control-block" style="margin-top:6px;">
              <select id="dimension-select" class="obs-select">
                <!-- Options are dynamically generated based on available dimensions -->
              </select>
            </div>
          </div>

          <!-- Navigation controls -->
          <div class="control-block" id="navigation-controls">
            <label>Navigation:</label>
            <div class="legend-help">
              Choose orbit for 3D exploration, planar for 2D embeddings, or free-fly for immersive movement.
            </div>
            <div class="control-block" style="margin-top:6px;">
              <label for="navigation-mode">Mode:</label>
              <select id="navigation-mode" class="obs-select">
                <option value="orbit">Orbit</option>
                <option value="planar">Planar</option>
                <option value="free">Free-fly</option>
              </select>
            </div>
            <div id="orbit-controls" class="nav-mode-box">
              <label class="checkbox-inline">
                <input type="checkbox" id="orbit-reverse" checked />
                Google Earth-style drag
              </label>
              <label class="checkbox-inline">
                <input type="checkbox" id="show-orbit-anchor" checked />
                Show orbit anchor
              </label>
            </div>
            <div id="planar-controls" class="nav-mode-box" style="display:none;">
              <label class="checkbox-inline">
                <input type="checkbox" id="planar-zoom-to-cursor" checked />
                Zoom to cursor (pinch-style)
              </label>
              <label class="checkbox-inline">
                <input type="checkbox" id="planar-invert-axes" />
                Invert look axes
              </label>
            </div>
            <div id="freefly-controls" class="nav-mode-box" style="display:none;">
              <div class="control-block" style="margin-top:6px;">
                <label for="look-sensitivity">Look sensitivity:</label>
                <div class="slider-row">
                  <input id="look-sensitivity" type="range" min="1" max="30" step="1" value="5" />
                  <span id="look-sensitivity-display" class="slider-value">0.05x</span>
                </div>
              </div>
              <div class="control-block" style="margin-top:6px;">
                <label for="move-speed">Move speed:</label>
                <div class="slider-row">
                  <input id="move-speed" type="range" min="1" max="500" step="1" value="100" />
                  <span id="move-speed-display" class="slider-value">1.00 u/s</span>
                </div>
              </div>
              <div class="control-block" style="margin-top:6px;">
                <label class="checkbox-inline">
                  <input type="checkbox" id="invert-look" />
                  Invert look axes
                </label>
              </div>
              <div class="control-block" style="margin-top:6px;">
                <label class="checkbox-inline">
                  <input type="checkbox" id="projectiles-enabled" />
                  Projectile shooting
                </label>
              </div>
              <div class="control-block" style="margin-top:6px;">
                <label class="checkbox-inline">
                  <input type="checkbox" id="pointer-lock" />
                  Capture pointer
                </label>
                <div class="legend-help" style="margin-top:6px;">
                  Hides the cursor and lets you look without dragging. Press Esc to release.
                </div>
              </div>
              <div class="legend-help" style="margin-top:6px;">
                Free-fly: click+drag to look • WASD move • E up • Q down • Shift sprint.
              </div>
            </div>
          </div>
        </div>
      </details>

      <details class="accordion-section" open>
        <summary>Filtering</summary>
        <div class="accordion-content">
          <!-- Color by obs -->
          <div class="control-block">
            <div class="field-select">
              <label for="categorical-field">Categorical obs:</label>
              <select id="categorical-field" class="obs-select"></select>
            </div>
            <div class="field-select">
              <label for="continuous-field">Continuous obs:</label>
              <select id="continuous-field" class="obs-select"></select>
            </div>
            <!-- Gene Expression Dropdown with Search -->
            <div class="field-select" id="gene-expression-container">
              <label for="gene-expression-search">Gene Expression:</label>
              <div class="searchable-dropdown">
                <input
                  type="text"
                  id="gene-expression-search"
                  class="search-input"
                  placeholder="Search genes..."
                  autocomplete="off"
                />
                <div id="gene-expression-dropdown" class="dropdown-list"></div>
                <div id="gene-expression-selected" class="selected-gene"></div>
              </div>
            </div>
          </div>

          <!-- Display Options (dashed box) -->
          <div class="display-options-box" id="display-options-container">
            <label>Display options:</label>

            <!-- Outlier Filter (only shown for categorical fields) -->
            <div class="control-block" id="outlier-filter-container">
              <label for="outlier-filter">Outlier filter (latent space):</label>
              <div class="slider-row">
                <input id="outlier-filter" type="range" min="0" max="100" step="1" value="100" />
                <span id="outlier-filter-display" class="slider-value">100%</span>
              </div>
            </div>

            <!-- Centroid controls (categorical fields only) -->
            <div class="control-block" id="centroid-controls">
              <label class="checkbox-inline">
                <input type="checkbox" id="toggle-centroid-points" />
                Show centroids
              </label>
              <label class="checkbox-inline">
                <input type="checkbox" id="toggle-centroid-labels" />
                Show labels
              </label>
            </div>

            <!-- Legend / category controls -->
            <div id="legend"></div>
          </div>
          <div class="control-block" id="active-filters-container">
            <label>Active filters:</label>
            <div id="filter-count" class="filter-info">Showing all points</div>
            <div id="active-filters" class="filter-info-block">
              <div class="filter-info">No filters active</div>
            </div>
          </div>
        </div>
      </details>

      <details class="accordion-section" open id="highlighted-cells-section">
        <summary>Highlighted Cells</summary>
        <div class="accordion-content">
          <div class="highlight-mode-box">
            <label>Highlight mode:</label>
            <div class="highlight-mode-buttons" role="group" aria-label="Highlight mode selection">
              <button type="button" class="toggle-switch highlight-mode-btn" data-mode="annotation" aria-pressed="true">Annotation based</button>
              <button type="button" class="toggle-switch highlight-mode-btn" data-mode="knn">KNN drag</button>
              <button type="button" class="toggle-switch highlight-mode-btn" data-mode="proximity">Proximity drag</button>
              <button type="button" class="toggle-switch highlight-mode-btn" data-mode="lasso">Lasso</button>
            </div>
            <div id="highlight-mode-description" class="legend-help">
              Alt+click a cell to highlight its group. Alt+drag to select a range.
            </div>
          </div>
          <!-- Page selector tabs -->
          <div id="highlight-pages-container">
            <div id="highlight-pages-tabs">
              <!-- Page tabs will be added here dynamically -->
            </div>
            <button type="button" class="highlight-page-add-btn" id="add-highlight-page" title="Add new page">+</button>
          </div>
          <div id="highlighted-groups" class="highlighted-groups-box">
            <div id="highlight-count" class="filter-info highlight-count-inline">No cells highlighted</div>
            <div id="highlighted-groups-list">
              <!-- Highlighted group items will be added here dynamically -->
            </div>
          </div>
          <div id="highlight-actions" class="highlight-actions" style="display: none;">
            <button type="button" class="btn-small" id="clear-all-highlights">Clear All</button>
          </div>
        </div>
      </details>

      <details class="accordion-section" id="benchmark-section">
        <summary>Performance Benchmark</summary>
        <div class="accordion-content">
          <div class="legend-help" style="margin-bottom:0px;">
            Test rendering limits with synthetic data
          </div>

          <!-- Quick presets -->
          <div class="control-block">
            <label>Quick test:</label>
            <div class="benchmark-presets" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:4px;margin-top:4px;">
              <button class="btn-small benchmark-preset" data-count="100000">100K</button>
              <button class="btn-small benchmark-preset" data-count="500000">500K</button>
              <button class="btn-small benchmark-preset" data-count="1000000">1M</button>
              <button class="btn-small benchmark-preset" data-count="5000000">5M</button>
              <button class="btn-small benchmark-preset" data-count="10000000">10M</button>
              <button class="btn-small benchmark-preset" data-count="20000000">20M</button>
            </div>
          </div>

          <!-- Custom count -->
          <div class="control-block" style="margin-top:8px;">
            <label for="benchmark-count">Custom point count:</label>
            <input type="number" id="benchmark-count" value="1000000" min="1000" max="50000000" step="100000" class="obs-select" style="width:120px;padding:5px 8px;" />
          </div>

          <!-- Pattern selection -->
          <div class="control-block" style="margin-top:8px;">
            <label for="benchmark-pattern">Data pattern:</label>
            <select id="benchmark-pattern" class="obs-select">
              <option value="glb" selected>3D Model Surface</option>
              <option value="atlas">Atlas-like (multiscale clusters)</option>
              <option value="batches">Batch Effects (misaligned)</option>
              <option value="clusters">Gaussian Clusters (100-200)</option>
              <option value="uniform">Uniform Random</option>
              <option value="octopus">Octopus (3D Tentacles)</option>
              <option value="spirals">3D Spirals</option>
              <option value="flatumap">2D UMAP (Flat)</option>
            </select>
          </div>

          <!-- Run button -->
          <div class="control-block" style="margin-top:10px;">
            <button id="benchmark-run" class="btn-small" style="width:100%;padding:8px 10px;">
              Load Synthetic Data
            </button>
          </div>

          <!-- Stats display -->
          <div id="benchmark-stats" style="margin-top:12px;padding:12px;background:#f8f9fa;border:1px solid #e5e7eb;border-radius:0;box-shadow:2px 2px 0 rgba(0,0,0,0.08);font-family:'Fira Code',monospace;font-size:11px;display:none;">
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px 16px;">
              <div>
                <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;">Points</div>
                <div id="bench-points" style="font-size:18px;font-weight:700;color:#111;">-</div>
              </div>
              <div>
                <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;">FPS</div>
                <div id="bench-fps" style="font-size:18px;font-weight:700;color:#22c55e;">-</div>
              </div>
              <div>
                <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;">Frame Time</div>
                <div id="bench-frametime" style="font-size:13px;color:#333;">-</div>
              </div>
              <div>
                <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;">GPU Memory</div>
                <div id="bench-memory" style="font-size:13px;color:#333;">-</div>
              </div>
              <div>
                <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;">LOD Level</div>
                <div id="bench-lod" style="font-size:13px;color:#333;">-</div>
              </div>
              <div>
                <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;">Visible Points</div>
                <div id="bench-visible" style="font-size:13px;color:#333;">-</div>
              </div>
            </div>
            <!-- Detailed timing stats -->
            <div id="bench-timing-details" style="margin-top:10px;padding-top:8px;border-top:1px solid #e5e7eb;display:none;">
              <div style="color:#666;font-size:9px;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;">Timing Details</div>
              <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;font-size:10px;">
                <div><span style="color:#888;">min:</span> <span id="bench-min-ft">-</span></div>
                <div><span style="color:#888;">p95:</span> <span id="bench-p95-ft">-</span></div>
                <div><span style="color:#888;">max:</span> <span id="bench-max-ft">-</span></div>
              </div>
            </div>
            <!-- Data generation info -->
            <div id="bench-gen-info" style="margin-top:8px;font-size:10px;color:#666;display:none;">
              Generated in <span id="bench-gen-time">-</span>ms
            </div>
          </div>

          <div class="control-block" style="margin-top:10px;">
            <button id="benchmark-report-btn" class="btn-small" style="width:100%;padding:8px 10px;">
              Copy Situation Report
            </button>
            <textarea id="benchmark-report-output" readonly style="display:none;"></textarea>
          </div>

          <div class="legend-help" style="margin-top:8px;">
            <strong>Tips:</strong> Adjust renderer settings in Visualization section.
            Reload page to restore original data.
          </div>
        </div>
      </details>
    </div>

    <div id="stats" class="sr-only">Loading data…</div>

	    <div id="copyright">
	      © Kemal Inecik · <a href="https://kemalinecik.com" target="_blank" rel="noopener noreferrer">kemalinecik.com</a>
	    </div>
		  </div>
	  </div>

  <!-- HTML layer for centroid labels -->
  <div id="label-layer"></div>
  <!-- Titles for small multiple viewports -->
  <div id="view-title-layer"></div>

  <!-- glMatrix for matrix math (self-hosted) -->
  <script src="assets/external/gl-matrix-min.js"></script>
  <script type="module" src="assets/js/app/main.js"></script>
</body>
</html>
